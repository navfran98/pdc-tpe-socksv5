#ifndef PROTOS2022A_SOCKSTM
#define PROTOS2022A_SOCKSTM


#include "./headers/stm.h"

// Estados
// 1. Client Greeting
// 2. Server greeting analysis (si la VER != 5 chau, si nos piden otra cosa que no sea U/P chau)
//  . Method selection msg (en nuestro caso le decimos que usamos U/P)
// 3. Client auth request msg (nos envian las credenciales de usr)
// 4. Analisamos si es correcta el usr y la contra
//  . Server greeting response (OK ==> se conecta / NOK ==> chau conexion)

/////////////////////////////////////////////////////////////////////////
//                           GREETING_READ                             //
/////////////////////////////////////////////////////////////////////////


/////////////////////////////////////////////////////////////////////////
//                           GREETING_WRITE                            //
/////////////////////////////////////////////////////////////////////////


/////////////////////////////////////////////////////////////////////////
//                             AUTH_READ                               //
/////////////////////////////////////////////////////////////////////////


/////////////////////////////////////////////////////////////////////////
//                             AUTH_WRITE                              //
/////////////////////////////////////////////////////////////////////////


/////////////////////////////////////////////////////////////////////////
//                                DONE                                 //
/////////////////////////////////////////////////////////////////////////


/////////////////////////////////////////////////////////////////////////
//                         ERROR_GLOBAL_STATE                          //
/////////////////////////////////////////////////////////////////////////


enum socksv5_global_state {

    // 1
    GREETING_READ = 0,
    // 2
    GREETING_WRITE,
    // 3
    AUTH_READ,
    // 4
    AUTH_WRITE,

    DONE,
    ERROR_GLOBAL_STATE
};

const struct state_definition * socksv5_describe_states(void);


#endif